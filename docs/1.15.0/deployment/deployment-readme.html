<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>How to Deploy Cumulus · Cumulus Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# How to Deploy Cumulus"/><meta name="docsearch:version" content="1.15.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="How to Deploy Cumulus · Cumulus Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://nasa.github.io/cumulus/"/><meta property="og:description" content="# How to Deploy Cumulus"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/cumulus/undefined"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/cumulus/js/scrollSpy.js"></script><link rel="stylesheet" href="/cumulus/css/main.css"/><script src="/cumulus/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/cumulus/"><h2 class="headerTitle">Cumulus Documentation</h2></a><a href="/cumulus/versions"><h3>1.15.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://nasa.github.io/cumulus-api" target="_self">API Docs</a></li><li class="siteNavGroupActive"><a href="/cumulus/docs/1.15.0/cumulus-docs-readme" target="_self">Developer Docs</a></li><li class=""><a href="/cumulus/docs/1.15.0/data-cookbooks/about-cookbooks" target="_self">Data-Cookbooks</a></li><li class=""><a href="/cumulus/docs/1.15.0/operator-docs/about-operator-docs" target="_self">Operator Docs</a></li><li class="siteNavGroupActive"><a href="/cumulus/docs/1.15.0/team" target="_self">Team</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Deployment</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">About Cumulus<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/cumulus-docs-readme">Cumulus Description</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/architecture">Cumulus Architecture</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/interfaces">Cumulus Interfaces</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/glossary">Cumulus Glossary</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/team">Team</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">What are Cumulus Workflows?<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/workflows-readme">Workflows</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/protocol">Workflow Protocol</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/input_output">Workflows Input &amp; Output</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/cumulus-task-message-flow">Cumulus Tasks: Message Flow</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/developing-workflow-tasks">Developing Workflow Tasks</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/lambda">Develop Lambda Functions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/docker">Dockerizing Data Processing</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/workflow-configuration-how-to">Workflow Configuration How To&#x27;s</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflows/workflow-triggers">Workflow Triggers</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Tasks<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/tasks">Cumulus Tasks</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflow_tasks/discover_granules">Discover Granules</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflow_tasks/files_to_granules">Files To Granules</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflow_tasks/move_granules">Move Granules</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/workflow_tasks/parse_pdr">Parse PDR</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Deployment<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/deployment-readme">How to Deploy Cumulus</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/components">Cumulus Components</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/create_bucket">Creating an S3 Bucket</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/server_access_logging">S3 Server Access Logging</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/iam_roles">Cumulus IAM Roles</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/obtain_cumulus_packages">Obtaining Cumulus Packages</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/config_descriptions">Configuration Descriptions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/cmr_launchpad_authentication">CMR Launchpad Authentication</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/cumulus_api_launchpad_authentication">Cumulus API Launchpad Authentication</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/troubleshoot_deployment">Troubleshooting Cumulus Deployment</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/distribution_component">Cumulus Distribution Terraform Module</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/deployment/thin_egress_app">Thin Egress App</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Deployment Options<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/additional-deployment-options/delete-api-gateway-stages">Delete API Gateway Stages</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/additional-deployment-options/enable-gateway-logging-permissions">API Gateway Logging Permissions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/additional-deployment-options/enable-api-logs">Enable API Gateway Logging</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/additional-deployment-options/configure-cloudwatch-logs-delivery">API Gateway Logs Delivery</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/additional-deployment-options/additional-lambda-logging">Lambda Log Subscriptions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/additional-deployment-options/share-s3-access-logs">Share S3 Access Logs</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Additional Features<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/features/dead_letter_queues">Dead Letter Queues</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/features/ems_reporting">EMS Reporting</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/features/execution_payload_retention">Execution Payload Retention</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/features/lambda_versioning">Lambda Versioning</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/features/ancillary_metadata">Ancillary Metadata Export</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/features/distribution-metrics">Cumulus Distribution Metrics</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Upgrading Cumulus<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/upgrade/upgrade-readme">Upgrading Cumulus</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Troubleshooting<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/system-documentation/system-documentation">Troubleshooting Cumulus</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Cumulus Development<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/adding-a-task">Contributing a Task</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/1.15.0/docs-how-to">Cumulus Documentation: How To&#x27;s</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="how-to-deploy-cumulus"></a><a href="#how-to-deploy-cumulus" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to Deploy Cumulus</h1>
<h2><a class="anchor" aria-hidden="true" id="overview"></a><a href="#overview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h2>
<p>This is a guide for deploying a new instance of Cumulus.</p>
<p><strong>Note:</strong> Cumulus is in the process of moving from a monolithic deployment to
a more modular deployment process. This document describes the current process.
Instructions for deploying Cumulus components can be found <a href="/cumulus/docs/1.15.0/deployment/components">here</a>.</p>
<p>This deployment document is current for the following component versions:</p>
<ul>
<li><a href="https://github.com/nasa/cumulus">Cumulus</a></li>
<li><a href="https://github.com/nasa/template-deploy">Deployment Template</a></li>
<li><a href="https://github.com/nasa/cumulus-dashboard">Cumulus Dashboard</a></li>
</ul>
<p>The process involves:</p>
<ul>
<li>Creating <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html">AWS S3 Buckets</a>.</li>
<li>Using <a href="http://devseed.com/kes/">Kes</a> to transform kes templates (<code>cloudformation.template.yml</code>) into <a href="https://aws.amazon.com/cloudformation/getting-started/">AWS CloudFormation</a> stack templates (<code>cloudformation.yml</code>) that are then deployed to AWS.</li>
<li>Before deploying the Cumulus software, a CloudFormation stack is deployed that creates necessary <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">IAM roles</a> via the <code>iam</code> stack.</li>
<li>Database resources are configured and deployed via the <code>db</code> stack.</li>
<li>The Cumulus software is configured and deployed via the <code>app</code> stack.</li>
</ul>
<hr>
<h2><a class="anchor" aria-hidden="true" id="requirements"></a><a href="#requirements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requirements</h2>
<h3><a class="anchor" aria-hidden="true" id="linuxmacos-software-requirements"></a><a href="#linuxmacos-software-requirements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Linux/MacOS software requirements</h3>
<ul>
<li>git</li>
<li><a href="https://nodejs.org/en/">node 8.10</a> (use <a href="https://github.com/creationix/nvm">nvm</a> to upgrade/downgrade)</li>
<li><a href="https://www.npmjs.com/get-npm">npm</a></li>
<li>sha1sum or md5sha1sum</li>
<li>zip</li>
<li>AWS CLI - <a href="https://aws.amazon.com/cli/">AWS command line interface</a></li>
<li>python</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="credentials"></a><a href="#credentials" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Credentials</h3>
<ul>
<li><a href="https://earthdata.nasa.gov/about/science-system-description/eosdis-components/common-metadata-repository">CMR</a> username and password.  CMR credentials must be provided if you are exporting metadata to CMR with EarthData Client Login authentication. More information about CMR configuration can be found <a href="./config_descriptions#cmr">here</a>.</li>
<li><a href="https://launchpad.nasa.gov">Launchpad</a>.  Launchpad credentials must be provided if you are using Launchpad authentication to export metadata to CMR or to authenticate with the Cumulus API. More information about CMR and Cumulus Launchpad authentication and configuration can be found <a href="./config_descriptions#launchpad">here</a>.</li>
<li><a href="https://earthdata.nasa.gov/about/science-system-description/eosdis-components/earthdata-login">EarthData Client login</a> username and password. User must have the ability to administer and/or create applications in URS.  It's recommended to obtain an account in the test environment (UAT).</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="needed-git-repositories"></a><a href="#needed-git-repositories" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Needed Git Repositories</h3>
<ul>
<li><a href="https://github.com/nasa/cumulus">Cumulus</a> (optional)</li>
<li><a href="https://github.com/nasa/cumulus-dashboard">Cumulus Dashboard</a></li>
<li><a href="https://github.com/nasa/cumulus-template-deploy">Deployment Template</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="installation"></a><a href="#installation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<h3><a class="anchor" aria-hidden="true" id="prepare-daac-deployment-repository"></a><a href="#prepare-daac-deployment-repository" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prepare DAAC deployment repository</h3>
<p><em>If you already are working with an existing <code>&lt;daac&gt;-deploy</code> repository that is configured appropriately for the version of Cumulus you intend to deploy or update, skip to <a href="deployment-readme#prepare-aws-configuration">Prepare AWS configuration.</a></em></p>
<p>Clone template-deploy repo and name appropriately for your DAAC or organization</p>
<pre><code class="hljs css language-bash">  $ git <span class="hljs-built_in">clone</span> https://github.com/nasa/template-deploy &lt;daac&gt;-deploy
</code></pre>
<p>Enter repository root directory</p>
<pre><code class="hljs css language-bash">  $ <span class="hljs-built_in">cd</span> &lt;daac&gt;-deploy
</code></pre>
<p>Then run:</p>
<pre><code class="hljs css language-bash">  $ nvm use
  $ npm install
</code></pre>
<p>If you do not have the correct version of node installed, replace <code>nvm use</code> with <code>nvm install $(cat .nvmrc)</code> in the above example.</p>
<p><strong>Note</strong>: The <code>npm install</code> command will add the <a href="http://devseed.com/kes/">kes</a> utility to the <code>&lt;daac&gt;-deploy</code>'s <code>node_modules</code> directory and will be utilized later for most of the AWS deployment commands.</p>
<h4><a class="anchor" aria-hidden="true" id="obtain-cumulus-packages"></a><a href="#obtain-cumulus-packages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Obtain Cumulus Packages</h4>
<p>Cumulus packages are installed from NPM using the <code>npm install</code> step above. For information on obtaining additional Cumulus packages, see <a href="deployment/obtain_cumulus_packages.md">Obtaining Cumulus Packages</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="copy-the-sample-template-into-your-repository"></a><a href="#copy-the-sample-template-into-your-repository" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Copy the sample template into your repository</h3>
<p>The <a href="https://github.com/nasa/cumulus"><code>Cumulus</code></a> project contains default configuration values in the <code>app.example</code> folder, however these need to be customized for your Cumulus app.</p>
<p>Begin by copying the template directory to your project. You will modify it for your DAAC's specific needs later.</p>
<pre><code class="hljs css language-bash">  $ cp -r ./node_modules/@cumulus/deployment/app.example ./app
</code></pre>
<p><strong>Optional:</strong> <a href="https://help.github.com/articles/creating-a-new-repository/">Create a new repository</a> <code>&lt;daac&gt;-deploy</code> so that you can track your DAAC's configuration changes:</p>
<pre><code class="hljs css language-bash">  $ git remote <span class="hljs-built_in">set</span>-url origin https://github.com/nasa/&lt;daac&gt;-deploy
  $ git push origin master
</code></pre>
<p>You can then <a href="https://help.github.com/articles/adding-a-file-to-a-repository-using-the-command-line/">add/commit</a> changes as needed.</p>
<h2><a class="anchor" aria-hidden="true" id="prepare-aws-configuration"></a><a href="#prepare-aws-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prepare AWS configuration</h2>
<h3><a class="anchor" aria-hidden="true" id="set-access-keys"></a><a href="#set-access-keys" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set Access Keys</h3>
<p>You need to make some AWS information available to your environment. If you don't already have the access key and secret access key of an AWS user with IAM Create-User permissions, you must <a href="https://docs.aws.amazon.com/general/latest/gr/managing-aws-access-keys.html">Create Access Keys</a> for such a user with IAM Create-User permissions, then export the access keys:</p>
<pre><code class="hljs css language-bash">  $ <span class="hljs-built_in">export</span> AWS_ACCESS_KEY_ID=&lt;AWS access key&gt;
  $ <span class="hljs-built_in">export</span> AWS_SECRET_ACCESS_KEY=&lt;AWS secret key&gt;
  $ <span class="hljs-built_in">export</span> AWS_REGION=&lt;region&gt;
</code></pre>
<p>If you don't want to set environment variables, <a href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html">access keys can be stored locally via the AWS CLI.</a></p>
<h3><a class="anchor" aria-hidden="true" id="create-s3-buckets"></a><a href="#create-s3-buckets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create S3 Buckets</h3>
<p>See <a href="/cumulus/docs/1.15.0/deployment/create_bucket">creating s3 buckets</a> for more information on how to create a bucket.</p>
<p>The following s3 bucket should be created (replacing prefix with whatever you'd like, generally your organization/DAAC's name):</p>
<ul>
<li><code>&lt;prefix&gt;-internal</code></li>
</ul>
<p>You can create additional s3 buckets based on the needs of your workflows.</p>
<p>These buckets do not need any non-default permissions to function with Cumulus, however your local security requirements may vary.</p>
<p><strong>Note</strong>: s3 bucket object names are global and must be unique across all accounts/locations/etc.</p>
<h3><a class="anchor" aria-hidden="true" id="vpc-subnets-and-security-group"></a><a href="#vpc-subnets-and-security-group" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>VPC, Subnets and Security Group</h3>
<p>Cumulus supports operation within a VPC, but you will need to separately create:</p>
<ul>
<li>VPC</li>
<li>Subnet</li>
<li>Security group</li>
<li>VPC endpoints for the various services used by Cumulus if you wish to route traffic through the VPC</li>
</ul>
<p>These resources only need to be created once per account.</p>
<p>If you are deploying to an NGAP environment (a NASA managed AWS environment), the VPC, subnet, security group, and VPC endpoints should already be created for you.</p>
<p>Note: Amazon ElasticSearch Service does not use a VPC Endpoint. To use ES within a VPC, run <code>aws iam create-service-linked-role --aws-service-name es.amazonaws.com</code> before deploying. This operation only needs to be done once per account, but it must be done for both NGAP and regular AWS environments.</p>
<p>To configure Cumulus with these settings, populate your <code>app/.env</code> file with the relevant values, as shown in the next section, before deploying Cumulus.
If these values are omitted Cumulus resources that require a VPC will be created in the default VPC and security group.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="earthdata-application"></a><a href="#earthdata-application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Earthdata Application</h2>
<h3><a class="anchor" aria-hidden="true" id="configure-earthdata-application"></a><a href="#configure-earthdata-application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure EarthData application</h3>
<p>The Cumulus stack is expected to authenticate with <a href="https://urs.earthdata.nasa.gov/documentation">Earthdata Login</a>. You must create and register a new application. Use the <a href="https://uat.urs.earthdata.nasa.gov">User Acceptance Tools (UAT) site</a> unless you intend use a different URS environment (which will require updating the <code>urs_url</code> value shown below). Follow the directions on <a href="https://wiki.earthdata.nasa.gov/display/EL/How+To+Register+An+Application">how to register an application.</a>.  Use any url for the <code>Redirect URL</code>, it will be deleted in a later step. Also note the password in step 3 and client ID in step 4 use these to replace <code>EARTHDATA_CLIENT_ID</code> and <code>EARTHDATA_CLIENT_PASSWORD</code> in the <code>.env</code> file in the next step.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="configuring-the-cumulus-instance"></a><a href="#configuring-the-cumulus-instance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuring the Cumulus instance</h2>
<h3><a class="anchor" aria-hidden="true" id="set-up-an-environment-file"></a><a href="#set-up-an-environment-file" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set up an environment file</h3>
<p><em>If you're adding a new deployment to an existing configuration repository or re-deploying an existing Cumulus configuration you should skip to <a href="deployment-readme#deploy">Deploy the Cumulus Stack</a>, as these values should already be configured.</em></p>
<p>Copy <code>app/.env.sample</code> to <code>app/.env</code> and add CMR/earthdata client <a href="deployment-readme#credentials">credentials</a>:</p>
<pre><code class="hljs css language-shell">  CMR_USERNAME=cmrusername                    # CMR Username For CMR Ingest API
  CMR_PASSWORD=cmrpassword                    # CMR Password
  EARTHDATA_CLIENT_ID=clientid                # EarthData Application ClientId
  EARTHDATA_CLIENT_PASSWORD=clientpassword    # EarthData Application Password
  VPC_ID=someid                               # VPC ID
  SECURITY_GROUP=sg-0000abcd1234              # Security Group ID
  AWS_SUBNET=somesubnet                       # VPC Subnet
  AWS_ACCOUNT_ID=0000000                      # AWS Account ID
  AWS_REGION=awsregion                        # AWS Region
  TOKEN_SECRET=tokensecret                    # JWT Token Secret
  LAUNCHPAD_PASSPHRASE=launchpadpassphrase    # passphrase for Launchpad PKI certificate,
                                              # only set if Launchpad authentication is used
</code></pre>
<p>The <code>TOKEN_SECRET</code> is a string value used for signing and verifying <a href="https://jwt.io/">JSON Web Tokens (JWTs)</a> issued by the API. For security purposes, it is strongly recommended that this be a 32-character string.</p>
<p>Note that the <code>.env.sample</code> file may be hidden, so if you do not see it, show hidden files.</p>
<p>For security it is highly recommended that you prevent <code>app/.env</code> from being accidentally committed to the repository by keeping it in the <code>.gitignore</code> file at the root of this repository.</p>
<h3><a class="anchor" aria-hidden="true" id="configure-deployment-with-daac-deployappconfigyml"></a><a href="#configure-deployment-with-daac-deployappconfigyml" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure deployment with <code>&lt;daac&gt;-deploy/app/config.yml</code></h3>
<p><strong>Sample new deployment added to config.yml</strong>:</p>
<p>Descriptions of the fields can be found in <a href="deployment/config_descriptions.md">Configuration Descriptions</a>.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">dev:</span>                            <span class="hljs-comment"># deployment name</span>
  <span class="hljs-attr">prefix:</span> <span class="hljs-string">dev-cumulus</span>           <span class="hljs-comment"># Required. Prefixes stack names and CloudFormation-created resources and permissions</span>
  <span class="hljs-attr">prefixNoDash:</span> <span class="hljs-string">DevCumulus</span>      <span class="hljs-comment"># Required.</span>
  <span class="hljs-attr">useNgapPermissionBoundary:</span> <span class="hljs-literal">true</span>   <span class="hljs-comment"># for NASA NGAP accounts</span>

  <span class="hljs-attr">apiStage:</span> <span class="hljs-string">dev</span>                 <span class="hljs-comment"># Optional</span>

  <span class="hljs-attr">vpc:</span>                          <span class="hljs-comment"># Required for NGAP environments</span>
    <span class="hljs-attr">vpcId:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{VPC_ID}}</span>'</span>         <span class="hljs-comment"># this has to be set in .env</span>
    <span class="hljs-attr">subnets:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'<span class="hljs-template-variable">{{AWS_SUBNET}}</span>'</span>        <span class="hljs-comment"># this has to be set in .env</span>
    <span class="hljs-attr">securityGroup:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{SECURITY_GROUP}}</span>'</span>   <span class="hljs-comment"># this has to be set in .env</span>

  <span class="hljs-attr">ecs:</span>                          <span class="hljs-comment"># Required</span>
    <span class="hljs-attr">instanceType:</span> <span class="hljs-string">t2.micro</span>
    <span class="hljs-attr">desiredInstances:</span> <span class="hljs-number">0</span>
    <span class="hljs-attr">availabilityZone:</span> <span class="hljs-string">&lt;subnet-id-zone&gt;</span>
    <span class="hljs-attr">amiid:</span> <span class="hljs-string">&lt;some-ami-id&gt;</span>

  <span class="hljs-comment"># Required. You can specify a different bucket for the system_bucket</span>
  <span class="hljs-attr">system_bucket:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{buckets.internal.name}}</span>'</span>

  <span class="hljs-attr">buckets:</span>                          <span class="hljs-comment"># Bucket configuration. Required.</span>
    <span class="hljs-attr">internal:</span>
      <span class="hljs-attr">name:</span> <span class="hljs-string">dev-internal</span>            <span class="hljs-comment"># internal bucket name</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">internal</span>
    <span class="hljs-attr">private:</span>
      <span class="hljs-attr">name:</span> <span class="hljs-string">dev-private</span>             <span class="hljs-comment"># private bucket name</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">private</span>
    <span class="hljs-attr">protected:</span>
      <span class="hljs-attr">name:</span> <span class="hljs-string">dev-protected</span>           <span class="hljs-comment"># protected bucket name</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">protected</span>
    <span class="hljs-attr">public:</span>
      <span class="hljs-attr">name:</span> <span class="hljs-string">dev-cumulus-public</span>      <span class="hljs-comment"># public bucket name</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">public</span>
    <span class="hljs-attr">otherpublic:</span>                    <span class="hljs-comment"># Can have more than one of each type of bucket</span>
      <span class="hljs-attr">name:</span> <span class="hljs-string">dev-default</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">public</span>

  <span class="hljs-comment"># Optional</span>
  <span class="hljs-attr">urs_url:</span> <span class="hljs-string">https://uat.urs.earthdata.nasa.gov/</span> <span class="hljs-comment"># make sure to include the trailing slash</span>

  <span class="hljs-comment"># if not specified, the value of the API gateway backend endpoint is used</span>
  <span class="hljs-comment"># api_backend_url: https://apigateway-url-to-api-backend/ # make sure to include the trailing slash</span>

  <span class="hljs-comment"># if not specified, the value of the API gateway distribution endpoint is used</span>
  <span class="hljs-comment"># api_distribution_url: https://apigateway-url-to-distribution-app/ # make sure to include the trailing slash</span>

  <span class="hljs-comment"># Required. URS users who should have access to the dashboard application and Cumulus API.</span>
  <span class="hljs-attr">users:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">username:</span> <span class="hljs-string">&lt;user&gt;</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">username:</span> <span class="hljs-string">&lt;user2&gt;</span>

  <span class="hljs-comment"># Optional. Only necessary if you have workflows that integrate with CMR</span>
  <span class="hljs-attr">cmr:</span>
    <span class="hljs-attr">oauthProvider:</span> <span class="hljs-string">&lt;earthdata</span> <span class="hljs-string">or</span> <span class="hljs-string">launchpad&gt;</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{CMR_USERNAME}}</span>'</span>    <span class="hljs-comment"># required if oauthProvider is earthdata</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{CMR_PASSWORD}}</span>'</span>    <span class="hljs-comment"># required if oauthProvider is earthdata</span>
    <span class="hljs-attr">clientId:</span> <span class="hljs-string">'&lt;replace-with-daac-name&gt;-<span class="hljs-template-variable">{{prefix}}</span>'</span> <span class="hljs-comment"># Client-ID submitted to CMR to identify origin of requests.</span>
    <span class="hljs-attr">provider:</span> <span class="hljs-string">CUMULUS</span>                                  <span class="hljs-comment"># Target provider in CMR</span>

  <span class="hljs-attr">es:</span>                               <span class="hljs-comment"># Optional. Set to 'null' to disable elasticsearch.</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">myES5Domain</span>               <span class="hljs-comment"># Optional. Defaults to 'es5vpc'.</span>
    <span class="hljs-attr">elasticSearchMapping:</span> <span class="hljs-number">2</span>         <span class="hljs-comment"># Optional, triggers elasticSearch re-bootstrap.</span>
                                    <span class="hljs-comment"># Useful when e.g. mappings are updated.</span>

  <span class="hljs-comment"># Optional, only necessary if EMS reports will be submitted to EMS</span>
  <span class="hljs-attr">ems:</span>
    <span class="hljs-attr">provider:</span> <span class="hljs-string">CUMULUS</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">&lt;ems-host&gt;</span>
    <span class="hljs-attr">path:</span> <span class="hljs-string">&lt;ems-report-path&gt;</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">&lt;ems-username&gt;</span>
    <span class="hljs-attr">dataSource:</span> <span class="hljs-string">&lt;report-datasource&gt;</span>
    <span class="hljs-attr">submitReport:</span> <span class="hljs-literal">true</span>

  <span class="hljs-attr">oauth:</span>
    <span class="hljs-attr">provider:</span> <span class="hljs-string">launchpad</span>     <span class="hljs-comment"># If not provided, default authentication is Earthdata Login</span>
    <span class="hljs-attr">userGroup:</span> <span class="hljs-string">Cumulus-Dev</span>  <span class="hljs-comment"># Optional, only necessary if Launchpad authentication is used</span>

  <span class="hljs-comment"># Optional, only necessary if Launchpad authentication is used for CMR or CUMULUS API</span>
  <span class="hljs-attr">launchpad:</span>
    <span class="hljs-attr">api:</span> <span class="hljs-string">&lt;launchpad-api-endpoint&gt;</span>   <span class="hljs-comment"># e.g. https://api.launchpad.nasa.gov/api/sm/v1</span>
    <span class="hljs-attr">passphrase:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{LAUNCHPAD_PASSPHRASE}}</span>'</span>

  <span class="hljs-comment"># Optional if you are configuring Cumulus to authenticate the dashboard via NASA's Launchpad SAML implementation.</span>
  <span class="hljs-comment"># see Wiki: https://wiki.earthdata.nasa.gov/display/CUMULUS/Cumulus+SAML+Launchpad+Integration</span>
  <span class="hljs-attr">samlConfig:</span>
    <span class="hljs-attr">entityID:</span> <span class="hljs-string">'&lt;&lt;Configured SAML entity-id&gt;&gt;'</span>
    <span class="hljs-attr">assertionConsumerService:</span> <span class="hljs-string">'<span class="hljs-template-variable">{{Cumulus API endpoint}}</span>/saml/auth'</span>
    <span class="hljs-attr">idpLogin:</span> <span class="hljs-string">'&lt;&lt;nasa'</span><span class="hljs-string">s</span> <span class="hljs-string">saml2sso</span> <span class="hljs-string">endpoint&gt;&gt;'</span>
    <span class="hljs-attr">launchpadMetadataPath:</span> <span class="hljs-string">'s3 url to identity provider public metadata xml file'</span>


  <span class="hljs-attr">app:</span>                              <span class="hljs-comment"># Override params to be passed to the app stack ('iam' and 'db' also allowed)</span>
    <span class="hljs-attr">params:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">myAppStackParam</span>
        <span class="hljs-attr">value:</span> <span class="hljs-string">SomeValue</span>
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="deploying-the-cumulus-instance"></a><a href="#deploying-the-cumulus-instance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploying the Cumulus Instance</h2>
<p>The <code>template-deploy</code> repository contains a script named <code>deploy-all</code> to assist with deploying Cumulus.</p>
<pre><code class="hljs css language-bash">  $ DEPLOYMENT=&lt;replace-with-deployment-name&gt; AWS_PROFILE=&lt;replace-wth-profile-name&gt; npm run deploy-all
</code></pre>
<p>This script will run each stack's deploy script, in order. The subsections here cover deploying each stack in detail.</p>
<h3><a class="anchor" aria-hidden="true" id="deploy-the-cumulus-iam-stack"></a><a href="#deploy-the-cumulus-iam-stack" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy the Cumulus IAM stack</h3>
<p>The <code>iam</code> deployment creates 7 <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">roles</a> and an <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2_instance-profiles.html">instance profile</a> used internally by the Cumulus stack.</p>
<p><strong>Deploy <code>iam</code> stack</strong><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<pre><code class="hljs css language-bash">  $ DEPLOYMENT=&lt;iam-deployment-name&gt; \
      AWS_REGION=&lt;region&gt; \ <span class="hljs-comment"># e.g. us-east-1</span>
      AWS_PROFILE=&lt;profile&gt; \
      npm run deploy-iam
</code></pre>
<p><strong>Note</strong>: If this deployment fails check the deployment details in the AWS Cloud Formation Console for information. Permissions may need to be updated by your AWS administrator.</p>
<p>If the <code>iam</code> deployment command  succeeds, you should see 7 new roles in the <a href="https://console.aws.amazon.com/iam/home">IAM Console</a>:</p>
<ul>
<li><code>&lt;prefix&gt;-ecs</code></li>
<li><code>&lt;prefix&gt;-lambda-api-gateway</code></li>
<li><code>&lt;prefix&gt;-lambda-processing</code></li>
<li><code>&lt;prefix&gt;-scaling-role</code></li>
<li><code>&lt;prefix&gt;-steprole</code></li>
<li><code>&lt;prefix&gt;-distribution-api-lambda</code></li>
<li><code>&lt;prefix&gt;-migration-processing</code></li>
</ul>
<p>The same information can be obtained from the AWS CLI command: <code>aws iam list-roles</code>.</p>
<p>The <code>iam</code> deployment also creates an instance profile named <code>&lt;stack-name&gt;-ecs</code> that can be viewed from the AWS CLI command: <code>aws iam list-instance-profiles</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="deploy-the-cumulus-database-stack"></a><a href="#deploy-the-cumulus-database-stack" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy the Cumulus database stack</h3>
<p>This section will cover deploying the DynamoDB and ElasticSearch resources.
Reminder: ElasticSearch is optional and can be disabled using <code>es: null</code> in your <code>config.yml</code>.</p>
<p><strong>Deploy <code>db</code> stack</strong></p>
<pre><code class="hljs css language-bash">  $ DEPLOYMENT=&lt;cumulus-deployment-name&gt; \
      AWS_REGION=&lt;region&gt; \ <span class="hljs-comment"># e.g. us-east-1</span>
      AWS_PROFILE=&lt;profile&gt; \
      npm run deploy-db
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="deploy-the-cumulus-application-stack"></a><a href="#deploy-the-cumulus-application-stack" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy the Cumulus application stack</h3>
<p>This section will cover deploying the primary Cumulus stack, containing compute resources, workflows and all other AWS resources not covered in the two stacks above.</p>
<p>Once the preceding configuration steps have completed, run the following to deploy Cumulus from your <code>&lt;daac&gt;-deploy</code> root directory:</p>
<pre><code class="hljs css language-bash">  $ DEPLOYMENT=&lt;cumulus-deployment-name&gt; \
      AWS_REGION=&lt;region&gt; \ <span class="hljs-comment"># e.g. us-east-1</span>
      AWS_PROFILE=&lt;profile&gt; \
      npm run deploy-app
</code></pre>
<p>You can monitor the progess of the stack deployment from the <a href="https://console.aws.amazon.com/cloudformation/home">AWS CloudFormation Console</a>; this step takes a few minutes.</p>
<p>A successful completion will result in output similar to:</p>
<pre><code class="hljs css language-bash">  $ DEPLOYMENT=&lt;cumulus-deployment-name&gt; \
      AWS_REGION=&lt;region&gt; \ <span class="hljs-comment"># e.g. us-east-1</span>
      AWS_PROFILE=&lt;profile&gt; \
      npm run deploy-app

  Nested templates are found!

  Compiling nested template <span class="hljs-keyword">for</span> CumulusApiDistribution
  Zipping app/build/cumulus_api/0000UUID-ApiDistribution.zip <span class="hljs-keyword">for</span> ApiDistribution
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/lambdas/0000UUID-ApiDistribution.zip
  Template saved to app/CumulusApiDistribution.yml
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/CumulusApiDistribution.yml

  Compiling nested template <span class="hljs-keyword">for</span> CumulusApiBackend
  Zipping app/build/cumulus_api/0000UUID-ApiEndpoints.zip <span class="hljs-keyword">for</span> ApiEndpoints
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/0000UUID-ApiEndpoints.zip
  Template saved to app/CumulusApiBackend.yml
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/CumulusApiBackend.yml

  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/lambdas/0000UUID-HelloWorld.zip
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/lambdas/0000UUID-sqs2sf.zip
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/lambdas/0000UUID-KinesisOutboundEventLogger.zip

  Generating keys. It might take a few seconds!
  Keys Generated
  keys uploaded to S3

  Template saved to app/cloudformation.yml
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/cloudformation.yml
  Waiting <span class="hljs-keyword">for</span> the CF operation to complete
  CF operation is <span class="hljs-keyword">in</span> state of CREATE_COMPLETE

  Here are the important URLs <span class="hljs-keyword">for</span> this deployment:

  Distribution:  https://&lt;kido2r7kji&gt;.execute-api.us-east-1.amazonaws.com/dev/
  Add this url to URS:  https://&lt;kido2r7kji&gt;.execute-api.us-east-1.amazonaws.com/dev/redirect

  Api:  https://&lt;czbbkscuy6&gt;.execute-api.us-east-1.amazonaws.com/dev/
  Add this url to URS:  https://&lt;czbbkscuy6&gt;.execute-api.us-east-1.amazonaws.com/dev/token

  Uploading Workflow Input Templates
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/workflows/HelloWorldWorkflow.json
  Uploaded: s3://&lt;prefix&gt;-internal/&lt;prefix&gt;-cumulus/workflows/list.json
</code></pre>
<p><strong>Note:</strong> Be sure to copy the urls, as you will use them to update your EarthData application.</p>
<h3><a class="anchor" aria-hidden="true" id="update-earthdata-application"></a><a href="#update-earthdata-application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Update Earthdata Application.</h3>
<p>You will need to add two redirect urls to your EarthData login application.
Login to URS (UAT), and under My Applications -&gt; Application Administration -&gt; use the edit icon of your application.  Then under Manage -&gt; redirect URIs, add the Backend API url returned from the stack deployment, e.g. <code>https://&lt;czbbkscuy6&gt;.execute-api.us-east-1.amazonaws.com/dev/token</code>.
Also add the Distribution url <code>https://&lt;kido2r7kji&gt;.execute-api.us-east-1.amazonaws.com/dev/redirect</code><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>. You may also delete the placeholder url you used to create the application.</p>
<p>If you've lost track of the needed redirect URIs, they can be located on the <a href="https://console.aws.amazon.com/apigateway">API Gateway</a>.  Once there select <code>&lt;prefix&gt;-backend</code> and/or <code>&lt;prefix&gt;-distribution</code>, <code>Dashboard</code> and utilizing the base URL at the top of the page that is accompanied by the text <code>Invoke this API at:</code>.   Make sure to append <code>/token</code> for the backend URL and <code>/redirect</code> to the distribution URL.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="deploy-cumulus-dashboard"></a><a href="#deploy-cumulus-dashboard" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy Cumulus dashboard</h2>
<h3><a class="anchor" aria-hidden="true" id="dashboard-requirements"></a><a href="#dashboard-requirements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dashboard Requirements</h3>
<p>Please note that the requirements are similar to the <a href="deployment-readme#requirements">Cumulus stack deployment requirements</a>, however the node version may vary slightly and the dashboard requires yarn.    The installation instructions below include a step that will install/use the required node version referenced in the <code>.nvmrc</code> file in the dashboard repository.</p>
<ul>
<li>git</li>
<li><a href="https://nodejs.org/en/">node 8.11.4</a> (use <a href="https://github.com/creationix/nvm">nvm</a> to upgrade/downgrade)</li>
<li><a href="https://www.npmjs.com/get-npm">npm</a></li>
<li><a href="https://yarnpkg.com/en/docs/install#mac-stable">yarn</a></li>
<li>sha1sum or md5sha1sum</li>
<li>zip</li>
<li>AWS CLI - <a href="https://aws.amazon.com/cli/">AWS command line interface</a></li>
<li>python</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="prepare-aws"></a><a href="#prepare-aws" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prepare AWS</h3>
<p><strong>Create S3 bucket for dashboard:</strong></p>
<ul>
<li>Create it, e.g. <code>&lt;prefix&gt;-dashboard</code>. Use the command line or console as you did when <a href="deployment-readme#prepare-aws-configuration">preparing AWS configuration</a>.</li>
<li>Configure the bucket to host a website:
<ul>
<li>AWS S3 console: Select <code>&lt;prefix&gt;-dashboard</code> bucket then, &quot;Properties&quot; -&gt; &quot;Static Website Hosting&quot;, point to <code>index.html</code></li>
<li>CLI: <code>aws s3 website s3://&lt;prefix&gt;-dashboard --index-document index.html</code></li>
</ul></li>
<li>The bucket's url will be <code>http://&lt;prefix&gt;-dashboard.s3-website-&lt;region&gt;.amazonaws.com</code> or you can find it on the AWS console via &quot;Properties&quot; -&gt; &quot;Static website hosting&quot; -&gt; &quot;Endpoint&quot;</li>
<li>Ensure the bucket's access permissions allow your deployment user access to write to the bucket</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="install-dashboard"></a><a href="#install-dashboard" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install dashboard</h3>
<p>To install the dashboard clone the Cumulus-dashboard repository into the root deploy directory and install dependencies with <code>yarn install</code>:</p>
<pre><code class="hljs css language-bash">  $ git <span class="hljs-built_in">clone</span> https://github.com/nasa/cumulus-dashboard
  $ <span class="hljs-built_in">cd</span> cumulus-dashboard
  $ nvm use
  $ yarn install
</code></pre>
<p>If you do not have the correct version of node installed, replace <code>nvm use</code> with <code>nvm install $(cat .nvmrc)</code> in the above example.</p>
<h4><a class="anchor" aria-hidden="true" id="dashboard-versioning"></a><a href="#dashboard-versioning" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dashboard versioning</h4>
<p>By default, the <code>master</code> branch will be used for dashboard deployments. The <code>master</code> branch of the dashboard repo contains the most recent stable release of the dashboard.</p>
<p>If you want to test unreleased changes to the dashboard, use the <code>develop</code> branch.</p>
<p>Each <a href="https://github.com/nasa/cumulus-dashboard/releases">release/version of the dashboard</a> will have <a href="https://github.com/nasa/cumulus-dashboard/tags">a tag in the dashboard repo</a>. Release/version numbers will use semantic versioning (major/minor/patch).</p>
<p>To checkout and install a specific version of the dashboard:</p>
<pre><code class="hljs css language-bash">  $ git fetch --tags
  $ git checkout &lt;version-number&gt; <span class="hljs-comment"># e.g. v1.2.0</span>
  $ nvm use
  $ yarn install
</code></pre>
<p>If you do not have the correct version of node installed, replace <code>nvm use</code> with <code>nvm install $(cat .nvmrc)</code> in the above example.</p>
<h3><a class="anchor" aria-hidden="true" id="dashboard-configuration"></a><a href="#dashboard-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dashboard configuration</h3>
<p>To configure your dashboard for deployment, update <code>cumulus-dashboard/app/scripts/config/config.js</code> by replacing the default apiRoot <code>https://wjdkfyb6t6.execute-api.us-east-1.amazonaws.com/dev/</code> with your app's apiRoot:<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p>
<pre><code class="hljs css language-javascript">    apiRoot: process.env.APIROOT || <span class="hljs-string">'https://&lt;czbbkscuy6&gt;.execute-api.us-east-1.amazonaws.com/dev/'</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="building-the-dashboard"></a><a href="#building-the-dashboard" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building the dashboard</h3>
<p><strong>Note</strong>: These environment variables are available during the build: <code>APIROOT</code>, <code>DAAC_NAME</code>, <code>STAGE</code>, <code>HIDE_PDR</code>. Any of these can be set on the command line to override the values contained in <code>config.js</code> when running the build below.</p>
<p>Build the dashboard from the dashboard repository root directory, <code>cumulus-dashboard</code>:</p>
<pre><code class="hljs css language-bash">  $ npm run build
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="dashboard-deployment"></a><a href="#dashboard-deployment" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dashboard deployment</h3>
<p>Deploy dashboard to s3 bucket from the <code>cumulus-dashboard</code> directory:</p>
<p>Using AWS CLI:</p>
<pre><code class="hljs css language-bash">  $ aws s3 sync dist s3://&lt;prefix&gt;-dashboard --acl public-read
</code></pre>
<p>From the S3 Console:</p>
<ul>
<li>Open the <code>&lt;prefix&gt;-dashboard</code> bucket, click 'upload'. Add the contents of the 'dist' subdirectory to the upload. Then select 'Next'. On the permissions window allow the public to view. Select 'Upload'.</li>
</ul>
<p>You should be able to visit the dashboard website at <code>http://&lt;prefix&gt;-dashboard.s3-website-&lt;region&gt;.amazonaws.com</code> or find the url
<code>&lt;prefix&gt;-dashboard</code> -&gt; &quot;Properties&quot; -&gt; &quot;Static website hosting&quot; -&gt; &quot;Endpoint&quot; and login with a user that you configured for access in the <a href="deployment-readme#configure-and-deploy-the-cumulus-stack">Configure and Deploy the Cumulus Stack</a> step.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="updating-cumulus-deployment"></a><a href="#updating-cumulus-deployment" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Updating Cumulus deployment</h2>
<p>Once deployed for the first time, any future updates to the role/stack configuration files/version of Cumulus can be deployed and will update the appropriate portions of the stack as needed.</p>
<h2><a class="anchor" aria-hidden="true" id="cumulus-versioning"></a><a href="#cumulus-versioning" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cumulus Versioning</h2>
<p>Cumulus uses a global versioning approach, meaning version numbers are consistent across all packages and tasks, and semantic versioning to track major, minor, and patch version (i.e. 1.0.0). We use Lerna to manage versioning.</p>
<h2><a class="anchor" aria-hidden="true" id="update-roles"></a><a href="#update-roles" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Update roles</h2>
<pre><code class="hljs css language-bash">  $ DEPLOYMENT=&lt;deployment-name&gt; \
      AWS_REGION=&lt;region&gt; \ <span class="hljs-comment"># e.g. us-east-1</span>
      AWS_PROFILE=&lt;profile&gt; \
      npm run deploy-iam
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="update-database"></a><a href="#update-database" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Update database</h2>
<pre><code class="hljs css language-bash">  $ DEPLOYMENT=&lt;deployment-name&gt; \
      AWS_REGION=&lt;region&gt; \ <span class="hljs-comment"># e.g. us-east-1</span>
      AWS_PROFILE=&lt;profile&gt; \
      npm run deploy-db
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="update-cumulus"></a><a href="#update-cumulus" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Update Cumulus</h2>
<pre><code class="hljs css language-bash">  $ DEPLOYMENT=&lt;deployment-name&gt; \
      AWS_REGION=&lt;region&gt; \ <span class="hljs-comment"># e.g. us-east-1</span>
      AWS_PROFILE=&lt;profile&gt; \
      npm run deploy-app
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="footnotes"></a><a href="#footnotes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Footnotes</h3>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1"  class="footnote-item"><p>The iam  actions require more permissions than a typical AWS user will have and should be run by an administrator. <a href="#fnref1" class="footnote-backref">↩</a></p>
</li>
<li id="fn2"  class="footnote-item"><p>To add another redirect URIs to your application. On EarthData home page, select &quot;My Applications&quot; Scroll down to &quot;Application Administration&quot; and use the edit icon for your application.  Then Manage -&gt; Redirect URIs. <a href="#fnref2" class="footnote-backref">↩</a></p>
</li>
<li id="fn3"  class="footnote-item"><p>The API root can be found a number of ways. The easiest is to note it in the output of the app deployment step. But you can also find it from the <code>AWS console -&gt; Amazon API Gateway -&gt; APIs -&gt; &lt;prefix&gt;-cumulus-backend -&gt; Dashboard</code>, and reading the URL at the top &quot;invoke this API&quot; <a href="#fnref3" class="footnote-backref">↩</a></p>
</li>
</ol>
</section>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/cumulus/docs/1.15.0/workflow_tasks/parse_pdr"><span class="arrow-prev">← </span><span>Parse PDR</span></a><a class="docs-next button" href="/cumulus/docs/1.15.0/deployment/components"><span>Cumulus Components</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#overview">Overview</a></li><li><a href="#requirements">Requirements</a><ul class="toc-headings"><li><a href="#linuxmacos-software-requirements">Linux/MacOS software requirements</a></li><li><a href="#credentials">Credentials</a></li><li><a href="#needed-git-repositories">Needed Git Repositories</a></li></ul></li><li><a href="#installation">Installation</a><ul class="toc-headings"><li><a href="#prepare-daac-deployment-repository">Prepare DAAC deployment repository</a></li><li><a href="#copy-the-sample-template-into-your-repository">Copy the sample template into your repository</a></li></ul></li><li><a href="#prepare-aws-configuration">Prepare AWS configuration</a><ul class="toc-headings"><li><a href="#set-access-keys">Set Access Keys</a></li><li><a href="#create-s3-buckets">Create S3 Buckets</a></li><li><a href="#vpc-subnets-and-security-group">VPC, Subnets and Security Group</a></li></ul></li><li><a href="#earthdata-application">Earthdata Application</a><ul class="toc-headings"><li><a href="#configure-earthdata-application">Configure EarthData application</a></li></ul></li><li><a href="#configuring-the-cumulus-instance">Configuring the Cumulus instance</a><ul class="toc-headings"><li><a href="#set-up-an-environment-file">Set up an environment file</a></li><li><a href="#configure-deployment-with-daac-deployappconfigyml">Configure deployment with <code>&lt;daac&gt;-deploy/app/config.yml</code></a></li></ul></li><li><a href="#deploying-the-cumulus-instance">Deploying the Cumulus Instance</a><ul class="toc-headings"><li><a href="#deploy-the-cumulus-iam-stack">Deploy the Cumulus IAM stack</a></li><li><a href="#deploy-the-cumulus-database-stack">Deploy the Cumulus database stack</a></li><li><a href="#deploy-the-cumulus-application-stack">Deploy the Cumulus application stack</a></li><li><a href="#update-earthdata-application">Update Earthdata Application.</a></li></ul></li><li><a href="#deploy-cumulus-dashboard">Deploy Cumulus dashboard</a><ul class="toc-headings"><li><a href="#dashboard-requirements">Dashboard Requirements</a></li><li><a href="#prepare-aws">Prepare AWS</a></li><li><a href="#install-dashboard">Install dashboard</a></li><li><a href="#dashboard-configuration">Dashboard configuration</a></li><li><a href="#building-the-dashboard">Building the dashboard</a></li><li><a href="#dashboard-deployment">Dashboard deployment</a></li></ul></li><li><a href="#updating-cumulus-deployment">Updating Cumulus deployment</a></li><li><a href="#cumulus-versioning">Cumulus Versioning</a></li><li><a href="#update-roles">Update roles</a></li><li><a href="#update-database">Update database</a></li><li><a href="#update-cumulus">Update Cumulus</a><ul class="toc-headings"><li><a href="#footnotes">Footnotes</a></li></ul></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f7e0be879553661f9043322d119069c8',
                indexName: 'nasa_cumulus',
                inputSelector: '#search_input_react'
              });
            </script></body></html>